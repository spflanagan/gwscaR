install.packages("roxygen2")
library(roxygen2)
install.packages("ade4")
library(ade4)
library(gwscaR)
source('~/.active-rstudio-document', echo=TRUE)
colnames(vcf)
grp1<-grep("FEM",colnames(vcf),value=T)
grp2<-c(grep("PRM",colnames(vcf),value=T),grep("NPM",colnames(vcf),value=T))
grp1
grp2
vcf$SNP<-paste(vcf$`#CHROM`,vcf$POS,sep=".")
locus.info<-c("#CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO","FORMAT","SNP")
grp1<-grep("FEM",colnames(vcf),value=T)
grp2<-c(grep("PRM",colnames(vcf),value=T),grep("NPM",colnames(vcf),value=T))
sel<-do.call("rbind",apply(vcf,1,fst.one.vcf,c(locus.info,grp1),c(locus.info,grp2),
cov.thresh=0.5,maf=0.05))
sel<-sel[!is.na(sel$Fst),] #Remove the ones that weren't polymorphic
sel<-do.call("rbind",apply(vcf,1,fst.one.vcf,c(locus.info,grp1),c(locus.info,grp2),
cov.thresh=0.5,maf=0.05))
dim(vcf)
sel<-do.call("rbind",apply(vcf,1,fst.one.vcf,c(locus.info,grp1),c(locus.info,grp2)))
vcf[1:5,1:20]
vcf.alleles(vcf[1,c(locus.info,grp1)])
vcf[1,c(locus.info,grp1)]
length(vcf.alleles(vcf[1,c(locus.info,grp1)]))
table(vcf.alleles(vcf[1,c(locus.info,grp1)]))
table(vcf.alleles(vcf[1,c(locus.info,grp1)]))/5
fst.one.vcf(vcf,grp1,grp2)
warnings()
fst.one.vcf(vcf,grp1,grp2)
sel<-gwsca(vcf,locus.info,grp1,grp2,prop.ind.thresh=0.5,maf.cutoff=0.05)
sel<-fst.one.vcf(vcf,c(locus.info,grp1),c(locus.info,grp2),
cov.thresh=0.5,maf=0.05)
head(sel)
